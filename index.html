<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>WebAR: 指定画像を出すだけ</title>

  <!-- A-Frame & AR.js（CDN） -->
  <script src="https://aframe.io/releases/1.4.1/aframe.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/ar.js/2.1.1/aframe-ar.min.js"></script>

  <style>
    html, body { height: 100%; margin: 0; overflow: hidden; }
    .hint {
      position: fixed; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,.6); color: #fff; padding: 8px 12px;
      font: 14px/1.4 system-ui, -apple-system, Segoe UI, Roboto, sans-serif; z-index: 10;
    }
    .hint b { font-weight: 700; }
  </style>

  <script>
    // 画像の“住所”。デフォルトは assets/character.png
    // URLに ?img=... を付ければ別の画像を指定可能（https推奨）
    const IMG_SRC = new URLSearchParams(location.search).get('img') || 'assets/character.png';

    // 画面下のヒントに現在の画像パスを表示
    document.addEventListener('DOMContentLoaded', () => {
      const el = document.getElementById('imgPath');
      if (el) el.textContent = IMG_SRC;
      // A-Frame の <img> アセットへ反映
      const img = document.getElementById('charSprite');
      img.setAttribute('crossorigin', 'anonymous'); // 外部URLに備えて
      img.setAttribute('src', IMG_SRC);
      img.addEventListener('error', () => {
        document.getElementById('status').textContent = '画像を読み込めませんでした。パス/拡張子/大文字小文字を確認。';
      });
      img.addEventListener('load', () => {
        document.getElementById('status').textContent = 'マーカーを映してください（HIRO）。';
      });
    });
  </script>
</head>
<body>
  <!-- 使い方（超要約）
       1) この index.html をGitHubに置く
       2) 画像を assets/character.png として置く（※小文字、スペースなし）
       3) GitHub Pages のURLを https で開き、カメラ許可 → HIROマーカーを映す
       4) 別名/別場所の画像は ?img=URL を付けて呼び出し可
          例: https://あなた.github.io/リポジトリ/?img=assets/idol.jpg
  -->

  <a-scene
    embedded
    vr-mode-ui="enabled: false"
    renderer="precision: medium; antialias: true; colorManagement: true"
    arjs="trackingMethod: best; sourceType: webcam; debugUIEnabled: true;"
  >
    <a-assets>
      <!-- ここに JS で IMG_SRC を流し込む -->
      <img id="charSprite" src="https://aagtk2983-cyber.github.io/image-for-AR2/assets/character.png">
    </a-assets>

    <!-- HIROマーカー上に “指定画像だけ” を表示（立て看板で見やすく） -->
    <a-marker preset="hiro">
      <a-image
        src="#charSprite"
        rotation="0 0 0"
        position="0 0.6 0"
        width="0.8" height="1.2"
        transparent="true"
        material="alphaTest:0.01">
      </a-image>

      <!-- ライト（画像には不要だが残してOK） -->
      <a-entity light="type: directional; intensity: 1" position="1 1 1"></a-entity>
      <a-entity light="type: ambient; intensity: 0.6"></a-entity>
    </a-marker>

    <a-entity camera></a-entity>
  </a-scene>

  <div class="hint">
    <div><b>画像:</b> <span id="imgPath">assets/character.png</span></div>
    <div id="status">読み込み中… カメラ許可が出たら「許可」を押す。</div>
  </div>
</body>
</html>
